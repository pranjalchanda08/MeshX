<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MeshX: app/components/meshx/elements/server/models/light_ctl_server/meshx_light_ctl_srv.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MeshX<span id="projectnumber">&#160;0.2</span>
   </div>
   <div id="projectbrief">This repository provides an implementation for Bluetooth Low Energy (BLE) Mesh network nodes using ESP32. The project allows you to create BLE mesh nodes that can communicate with each other, enabling the development of smart home solutions or other IoT-based applications.</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('meshx__light__ctl__srv_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">meshx_light_ctl_srv.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header file for the Light CTL Server module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="app__common_8h_source.html">app_common.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="meshx__light__server_8h_source.html">meshx_light_server.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="meshx__control__task_8h_source.html">meshx_control_task.h</a>&quot;</code><br />
</div>
<p><a href="meshx__light__ctl__srv_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aff553dc00583398d1e6c646650633ab4" id="r_aff553dc00583398d1e6c646650633ab4"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff553dc00583398d1e6c646650633ab4">meshx_light_ctl_server_init</a> (void)</td></tr>
<tr class="memdesc:aff553dc00583398d1e6c646650633ab4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the Light CTL Server.  <br /></td></tr>
<tr class="separator:aff553dc00583398d1e6c646650633ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac858c18a5315e634fd12e93839c6d562" id="r_ac858c18a5315e634fd12e93839c6d562"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac858c18a5315e634fd12e93839c6d562">meshx_send_ctl_status</a> (esp_ble_mesh_model_t *model, esp_ble_mesh_msg_ctx_t *ctx, uint16_t lightness, uint16_t temperature)</td></tr>
<tr class="memdesc:ac858c18a5315e634fd12e93839c6d562"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the Light CTL Status message to the client.  <br /></td></tr>
<tr class="separator:ac858c18a5315e634fd12e93839c6d562"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for the Light CTL Server module. </p>
<p>Copyright Â© 2024 - 2025 MeshX</p>
<p>This file contains the function declarations and necessary includes for initializing and managing the Light CTL Server in the BLE mesh network. </p>

<p class="definition">Definition in file <a class="el" href="meshx__light__ctl__srv_8h_source.html">meshx_light_ctl_srv.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aff553dc00583398d1e6c646650633ab4" name="aff553dc00583398d1e6c646650633ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff553dc00583398d1e6c646650633ab4">&#9670;&#160;</a></span>meshx_light_ctl_server_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t meshx_light_ctl_server_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the Light CTL Server. </p>
<p>This function initializes the Light CTL Server, setting up necessary configurations and preparing it to handle light control operations within the BLE mesh network.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>ESP_OK: Success</li>
<li>ESP_FAIL: Initialization failed</li>
</ul>
</dd></dl>
<p>Initialize the Light CTL Server.</p>
<p>This function initializes the Light CTL (Color Temperature Light) Server model for the BLE Mesh Node. It sets up the necessary configurations and state for the Light CTL Server to operate correctly.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>ESP_OK: Success</li>
<li>ESP_FAIL: Failure </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="meshx__light__ctl__srv_8c_source.html#l00280">280</a> of file <a class="el" href="meshx__light__ctl__srv_8c_source.html">meshx_light_ctl_srv.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>{</div>
<div class="line"><span class="lineno">  282</span>    esp_err_t err = ESP_OK;</div>
<div class="line"><span class="lineno">  283</span><span class="preprocessor">#if CONFIG_BLE_CONTROL_TASK_OFFLOAD_ENABLE</span></div>
<div class="line"><span class="lineno">  284</span>    <span class="comment">/* Protect only one registration */</span></div>
<div class="line"><span class="lineno">  285</span>    <span class="keyword">static</span> uint8_t init_cntr = 0;</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">if</span> (init_cntr)</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">return</span> ESP_OK;</div>
<div class="line"><span class="lineno">  288</span>    init_cntr++;</div>
<div class="line"><span class="lineno">  289</span><span class="preprocessor">#endif </span><span class="comment">/* CONFIG_BLE_CONTROL_TASK_OFFLOAD_ENABLE */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    err = <a class="code hl_function" href="meshx__light__server_8c.html#ab63328fa49e4325ea9689023dcb6900c">meshx_lighting_srv_init</a>();</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">if</span>(err)</div>
<div class="line"><span class="lineno">  293</span>        ESP_LOGE(TAG, <span class="stringliteral">&quot;Failed to initialize prod server&quot;</span>);</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>    err = <a class="code hl_function" href="meshx__light__server_8c.html#a92b913c2b2d978d6e48b034ff52248b3">meshx_lighting_reg_cb</a>(ESP_BLE_MESH_MODEL_ID_LIGHT_CTL_SRV, (<a class="code hl_typedef" href="meshx__light__server_8h.html#a6d3d66119a07be981c11bd47581a7223">meshx_lighting_server_cb</a>)&amp;meshx_handle_light_ctl_msg);</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">if</span>(err)</div>
<div class="line"><span class="lineno">  297</span>        ESP_LOGE(TAG, <span class="stringliteral">&quot;Failed to initialize meshx_gen_srv_reg_cb (Err: %d)&quot;</span>, err);</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    err = <a class="code hl_function" href="meshx__light__server_8c.html#a92b913c2b2d978d6e48b034ff52248b3">meshx_lighting_reg_cb</a>(ESP_BLE_MESH_MODEL_ID_LIGHT_CTL_SETUP_SRV, (<a class="code hl_typedef" href="meshx__light__server_8h.html#a6d3d66119a07be981c11bd47581a7223">meshx_lighting_server_cb</a>)&amp;meshx_handle_light_ctl_msg);</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">if</span>(err)</div>
<div class="line"><span class="lineno">  301</span>        ESP_LOGE(TAG, <span class="stringliteral">&quot;Failed to initialize meshx_gen_srv_reg_cb (Err: %d)&quot;</span>, err);</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  304</span>}</div>
<div class="ttc" id="ameshx__light__server_8c_html_a92b913c2b2d978d6e48b034ff52248b3"><div class="ttname"><a href="meshx__light__server_8c.html#a92b913c2b2d978d6e48b034ff52248b3">meshx_lighting_reg_cb</a></div><div class="ttdeci">esp_err_t meshx_lighting_reg_cb(uint32_t model_id, meshx_lighting_server_cb cb)</div><div class="ttdoc">Register a callback function for the lighting server model.</div><div class="ttdef"><b>Definition</b> <a href="meshx__light__server_8c_source.html#l00070">meshx_light_server.c:70</a></div></div>
<div class="ttc" id="ameshx__light__server_8c_html_ab63328fa49e4325ea9689023dcb6900c"><div class="ttname"><a href="meshx__light__server_8c.html#ab63328fa49e4325ea9689023dcb6900c">meshx_lighting_srv_init</a></div><div class="ttdeci">esp_err_t meshx_lighting_srv_init(void)</div><div class="ttdoc">Initialize the meshxuction lighting server.</div><div class="ttdef"><b>Definition</b> <a href="meshx__light__server_8c_source.html#l00112">meshx_light_server.c:112</a></div></div>
<div class="ttc" id="ameshx__light__server_8h_html_a6d3d66119a07be981c11bd47581a7223"><div class="ttname"><a href="meshx__light__server_8h.html#a6d3d66119a07be981c11bd47581a7223">meshx_lighting_server_cb</a></div><div class="ttdeci">esp_err_t(* meshx_lighting_server_cb)(esp_ble_mesh_lighting_server_cb_param_t *param)</div><div class="ttdoc">Type definition for the production lighting server callback function.</div><div class="ttdef"><b>Definition</b> <a href="meshx__light__server_8h_source.html#l00031">meshx_light_server.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac858c18a5315e634fd12e93839c6d562" name="ac858c18a5315e634fd12e93839c6d562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac858c18a5315e634fd12e93839c6d562">&#9670;&#160;</a></span>meshx_send_ctl_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t meshx_send_ctl_status </td>
          <td>(</td>
          <td class="paramtype">esp_ble_mesh_model_t *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_ble_mesh_msg_ctx_t *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>lightness</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>temperature</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the Light CTL Status message to the client. </p>
<p>This function sends the Light CTL Status message to the client with the specified lightness and temperature values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>Pointer to the Light CTL Server model. </td></tr>
    <tr><td class="paramname">ctx</td><td>Pointer to the BLE Mesh message context. </td></tr>
    <tr><td class="paramname">lightness</td><td>Lightness value to send. </td></tr>
    <tr><td class="paramname">temperature</td><td>Temperature value to send.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>ESP_OK: Success</li>
<li>ESP_FAIL: Failure </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="meshx__light__ctl__srv_8c_source.html#l00260">260</a> of file <a class="el" href="meshx__light__ctl__srv_8c_source.html">meshx_light_ctl_srv.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>{</div>
<div class="line"><span class="lineno">  262</span>    <a class="code hl_typedef" href="meshx__light__ctl__srv_8c.html#a1a222d2baabd16bf4ecb22a706d86d1c">ctl_status_t</a> ctl_status_pack;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    ctl_status_pack.ctl_status.lightness = lightness;</div>
<div class="line"><span class="lineno">  265</span>    ctl_status_pack.ctl_status.temperature = temperature;</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">return</span> esp_ble_mesh_server_model_send_msg(model, ctx, ESP_BLE_MESH_MODEL_OP_LIGHT_CTL_STATUS, <span class="keyword">sizeof</span>(ctl_status_pack.ctl_status), (uint8_t*)&amp;ctl_status_pack);</div>
<div class="line"><span class="lineno">  268</span>}</div>
<div class="ttc" id="ameshx__light__ctl__srv_8c_html_a1a222d2baabd16bf4ecb22a706d86d1c"><div class="ttname"><a href="meshx__light__ctl__srv_8c.html#a1a222d2baabd16bf4ecb22a706d86d1c">ctl_status_t</a></div><div class="ttdeci">union ctl_status ctl_status_t</div><div class="ttdoc">Light CTL status packet.</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d422163b96683743ed3963d4aac17747.html">app</a></li><li class="navelem"><a class="el" href="dir_c65bd19e757d26cf4d732c1ae0727ae8.html">components</a></li><li class="navelem"><a class="el" href="dir_f203b345362cbfbb0face6aabfa16576.html">meshx</a></li><li class="navelem"><a class="el" href="dir_c2430d1846e6737dc28beab6505d1845.html">elements</a></li><li class="navelem"><a class="el" href="dir_f70d4cb5ff268b8be3bc8afcf2a860df.html">server</a></li><li class="navelem"><a class="el" href="dir_52fa0432d7de8f815bb07a3ff7339bba.html">models</a></li><li class="navelem"><a class="el" href="dir_52b778701386367f03af2c00126422b7.html">light_ctl_server</a></li><li class="navelem"><a class="el" href="meshx__light__ctl__srv_8h.html">meshx_light_ctl_srv.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
