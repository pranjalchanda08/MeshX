<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MeshX: app/components/meshx/elements/client/models/gen_onoff_client/meshx_onoff_client.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MeshX<span id="projectnumber">&#160;0.2</span>
   </div>
   <div id="projectbrief">This repository provides an implementation for Bluetooth Low Energy (BLE) Mesh network nodes using ESP32. The project allows you to create BLE mesh nodes that can communicate with each other, enabling the development of smart home solutions or other IoT-based applications.</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d8/dd5/meshx__onoff__client_8h.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">meshx_onoff_client.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header file for the On/Off client model in BLE mesh.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;esp_ble_mesh_defs.h&gt;</code><br />
<code>#include &lt;esp_ble_mesh_common_api.h&gt;</code><br />
<code>#include &lt;esp_ble_mesh_networking_api.h&gt;</code><br />
<code>#include &lt;esp_ble_mesh_generic_model_api.h&gt;</code><br />
<code>#include &lt;esp_ble_mesh_local_data_operation_api.h&gt;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/semphr.h&quot;</code><br />
<code>#include &lt;sys/queue.h&gt;</code><br />
</div>
<p><a href="../../d8/dd5/meshx__onoff__client_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de6/structmeshx__onoff__cli__cb__reg.html">meshx_onoff_cli_cb_reg</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for On/Off client callback registration.  <a href="../../dd/de6/structmeshx__onoff__cli__cb__reg.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a664db840d8ac4280d88e7712cf277029" id="r_a664db840d8ac4280d88e7712cf277029"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a664db840d8ac4280d88e7712cf277029">meshx_onoff_cli_cb</a>) (const esp_ble_mesh_generic_client_cb_param_t *param, <a class="el" href="#a8a5070813dc59066d8b8bda9302caf07">meshx_onoff_cli_evt_t</a> evt)</td></tr>
<tr class="memdesc:a664db840d8ac4280d88e7712cf277029"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function type for On/Off client events.  <br /></td></tr>
<tr class="separator:a664db840d8ac4280d88e7712cf277029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f67e5ea8f4153315aa40a688c89767" id="r_a00f67e5ea8f4153315aa40a688c89767"><td class="memItemLeft" align="right" valign="top"><a id="a00f67e5ea8f4153315aa40a688c89767" name="a00f67e5ea8f4153315aa40a688c89767"></a>
typedef struct <a class="el" href="../../dd/de6/structmeshx__onoff__cli__cb__reg.html">meshx_onoff_cli_cb_reg</a>&#160;</td><td class="memItemRight" valign="bottom"><b>meshx_onoff_cli_cb_reg_t</b></td></tr>
<tr class="memdesc:a00f67e5ea8f4153315aa40a688c89767"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for On/Off client callback registration. <br /></td></tr>
<tr class="separator:a00f67e5ea8f4153315aa40a688c89767"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a8a5070813dc59066d8b8bda9302caf07" id="r_a8a5070813dc59066d8b8bda9302caf07"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a5070813dc59066d8b8bda9302caf07">meshx_onoff_cli_evt_t</a> { <br />
&#160;&#160;<b>MESHX_ONOFF_CLI_EVT_GET</b> = BIT(ESP_BLE_MESH_GENERIC_CLIENT_GET_STATE_EVT)
, <b>MESHX_ONOFF_CLI_EVT_SET</b> = BIT(ESP_BLE_MESH_GENERIC_CLIENT_SET_STATE_EVT)
, <b>MESHX_ONOFF_CLI_PUBLISH</b> = BIT(ESP_BLE_MESH_GENERIC_CLIENT_PUBLISH_EVT)
, <b>MESHX_ONOFF_CLI_TIMEOUT</b> = BIT(ESP_BLE_MESH_GENERIC_CLIENT_TIMEOUT_EVT)
, <br />
&#160;&#160;<b>MESHX_ONOFF_CLI_EVT_ALL</b> = (MESHX_ONOFF_CLI_EVT_GET | MESHX_ONOFF_CLI_EVT_SET | MESHX_ONOFF_CLI_PUBLISH | MESHX_ONOFF_CLI_TIMEOUT)
<br />
 }</td></tr>
<tr class="memdesc:a8a5070813dc59066d8b8bda9302caf07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration of On/Off client events.  <a href="#a8a5070813dc59066d8b8bda9302caf07">More...</a><br /></td></tr>
<tr class="separator:a8a5070813dc59066d8b8bda9302caf07"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aeb118713e80f8380f636641e44c30ebf" id="r_aeb118713e80f8380f636641e44c30ebf"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb118713e80f8380f636641e44c30ebf">meshx_onoff_client_init</a> (void)</td></tr>
<tr class="memdesc:aeb118713e80f8380f636641e44c30ebf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the On/Off client model.  <br /></td></tr>
<tr class="separator:aeb118713e80f8380f636641e44c30ebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3f328a8925dc2a3c8e621bbf1338bf" id="r_a6d3f328a8925dc2a3c8e621bbf1338bf"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d3f328a8925dc2a3c8e621bbf1338bf">meshx_onoff_reg_cb</a> (<a class="el" href="#a664db840d8ac4280d88e7712cf277029">meshx_onoff_cli_cb</a> cb, uint32_t config_evt_bmap)</td></tr>
<tr class="memdesc:a6d3f328a8925dc2a3c8e621bbf1338bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a callback function for On/Off client events.  <br /></td></tr>
<tr class="separator:a6d3f328a8925dc2a3c8e621bbf1338bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1d9f0072433cf6736049b57a50dbde5" id="r_af1d9f0072433cf6736049b57a50dbde5"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1d9f0072433cf6736049b57a50dbde5">meshx_onoff_client_send_msg</a> (esp_ble_mesh_model_t *model, uint16_t opcode, uint16_t addr, uint16_t net_idx, uint16_t app_idx, uint8_t state, uint8_t tid)</td></tr>
<tr class="memdesc:af1d9f0072433cf6736049b57a50dbde5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a generic on/off client message.  <br /></td></tr>
<tr class="separator:af1d9f0072433cf6736049b57a50dbde5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for the On/Off client model in BLE mesh. </p>
<p>Copyright © 2024 - 2025 MeshX</p>
<p>This file contains the definitions and function prototypes for the On/Off client model. </p>

<p class="definition">Definition in file <a class="el" href="../../d8/dd5/meshx__onoff__client_8h_source.html">meshx_onoff_client.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a664db840d8ac4280d88e7712cf277029" name="a664db840d8ac4280d88e7712cf277029"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a664db840d8ac4280d88e7712cf277029">&#9670;&#160;</a></span>meshx_onoff_cli_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* meshx_onoff_cli_cb) (const esp_ble_mesh_generic_client_cb_param_t *param, <a class="el" href="#a8a5070813dc59066d8b8bda9302caf07">meshx_onoff_cli_evt_t</a> evt)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function type for On/Off client events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">param</td><td>Pointer to the callback parameter structure. </td></tr>
    <tr><td class="paramname">evt</td><td>Event type. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/dd5/meshx__onoff__client_8h_source.html#l00037">37</a> of file <a class="el" href="../../d8/dd5/meshx__onoff__client_8h_source.html">meshx_onoff_client.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a8a5070813dc59066d8b8bda9302caf07" name="a8a5070813dc59066d8b8bda9302caf07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a5070813dc59066d8b8bda9302caf07">&#9670;&#160;</a></span>meshx_onoff_cli_evt_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a8a5070813dc59066d8b8bda9302caf07">meshx_onoff_cli_evt_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration of On/Off client events. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/dd5/meshx__onoff__client_8h_source.html#l00022">22</a> of file <a class="el" href="../../d8/dd5/meshx__onoff__client_8h_source.html">meshx_onoff_client.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>{</div>
<div class="line"><span class="lineno">   24</span>    MESHX_ONOFF_CLI_EVT_GET = BIT(ESP_BLE_MESH_GENERIC_CLIENT_GET_STATE_EVT),</div>
<div class="line"><span class="lineno">   25</span>    MESHX_ONOFF_CLI_EVT_SET = BIT(ESP_BLE_MESH_GENERIC_CLIENT_SET_STATE_EVT),</div>
<div class="line"><span class="lineno">   26</span>    MESHX_ONOFF_CLI_PUBLISH = BIT(ESP_BLE_MESH_GENERIC_CLIENT_PUBLISH_EVT),</div>
<div class="line"><span class="lineno">   27</span>    MESHX_ONOFF_CLI_TIMEOUT = BIT(ESP_BLE_MESH_GENERIC_CLIENT_TIMEOUT_EVT),</div>
<div class="line"><span class="lineno">   28</span>    MESHX_ONOFF_CLI_EVT_ALL = (MESHX_ONOFF_CLI_EVT_GET | MESHX_ONOFF_CLI_EVT_SET | MESHX_ONOFF_CLI_PUBLISH | MESHX_ONOFF_CLI_TIMEOUT)</div>
<div class="line"><span class="lineno">   29</span>} <a class="code hl_enumeration" href="#a8a5070813dc59066d8b8bda9302caf07">meshx_onoff_cli_evt_t</a>;</div>
<div class="ttc" id="ameshx__onoff__client_8h_html_a8a5070813dc59066d8b8bda9302caf07"><div class="ttname"><a href="#a8a5070813dc59066d8b8bda9302caf07">meshx_onoff_cli_evt_t</a></div><div class="ttdeci">meshx_onoff_cli_evt_t</div><div class="ttdoc">Enumeration of On/Off client events.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dd5/meshx__onoff__client_8h_source.html#l00022">meshx_onoff_client.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aeb118713e80f8380f636641e44c30ebf" name="aeb118713e80f8380f636641e44c30ebf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb118713e80f8380f636641e44c30ebf">&#9670;&#160;</a></span>meshx_onoff_client_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t meshx_onoff_client_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the On/Off client model. </p>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, or an error code on failure.</dd></dl>
<p>Initialize the On/Off client model.</p>
<p>This function initializes the OnOff Client by registering the BLE Mesh generic client callback.</p>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, or an error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d33/meshx__onoff__client_8c_source.html#l00129">129</a> of file <a class="el" href="../../d9/d33/meshx__onoff__client_8c_source.html">meshx_onoff_client.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>{</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> (meshx_client_init_flag == MESHX_CLIENT_INIT_MAGIC)</div>
<div class="line"><span class="lineno">  132</span>    {</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">return</span> ESP_OK;</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    meshx_onoff_cli_mutex = xSemaphoreCreateMutex();</div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">if</span> (meshx_onoff_cli_mutex == NULL)</div>
<div class="line"><span class="lineno">  138</span>    {</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">return</span> ESP_ERR_NO_MEM; <span class="comment">// Mutex creation failed</span></div>
<div class="line"><span class="lineno">  140</span>    }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">return</span> esp_ble_mesh_register_generic_client_callback((esp_ble_mesh_generic_client_cb_t)&amp;meshx_generic_client_cb);</div>
<div class="line"><span class="lineno">  143</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1d9f0072433cf6736049b57a50dbde5" name="af1d9f0072433cf6736049b57a50dbde5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1d9f0072433cf6736049b57a50dbde5">&#9670;&#160;</a></span>meshx_onoff_client_send_msg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t meshx_onoff_client_send_msg </td>
          <td>(</td>
          <td class="paramtype">esp_ble_mesh_model_t *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>opcode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>addr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>net_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>app_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>tid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a generic on/off client message. </p>
<p>This function sends a generic on/off client message with the specified parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>Pointer to the BLE Mesh model structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opcode</td><td>The operation code of the message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>The destination address to which the message is sent. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">net_idx</td><td>The network index to be used for sending the message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">app_idx</td><td>The application index to be used for sending the message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>The state value to be sent in the message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tid</td><td>The transaction ID to be used for the message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>ESP_OK: Success</li>
<li>ESP_ERR_INVALID_ARG: Invalid argument</li>
<li>ESP_ERR_NO_MEM: Out of memory</li>
<li>ESP_FAIL: Sending message failed </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d33/meshx__onoff__client_8c_source.html#l00164">164</a> of file <a class="el" href="../../d9/d33/meshx__onoff__client_8c_source.html">meshx_onoff_client.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  173</span>{</div>
<div class="line"><span class="lineno">  174</span>    esp_err_t err;</div>
<div class="line"><span class="lineno">  175</span>    esp_ble_mesh_client_common_param_t common = {0};</div>
<div class="line"><span class="lineno">  176</span>    esp_ble_mesh_generic_client_set_state_t set = {0};</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    common.model        = model;</div>
<div class="line"><span class="lineno">  179</span>    common.opcode       = opcode;</div>
<div class="line"><span class="lineno">  180</span>    common.ctx.addr     = addr;</div>
<div class="line"><span class="lineno">  181</span>    common.ctx.net_idx  = net_idx;</div>
<div class="line"><span class="lineno">  182</span>    common.ctx.app_idx  = app_idx;</div>
<div class="line"><span class="lineno">  183</span>    common.msg_timeout  = 0; <span class="comment">/* 0 indicates that timeout value from menuconfig will be used */</span></div>
<div class="line"><span class="lineno">  184</span>    common.ctx.send_ttl = 3;</div>
<div class="line"><span class="lineno">  185</span><span class="preprocessor">#if ESP_IDF_VERSION &lt; ESP_IDF_VERSION_VAL(5, 2, 0)</span></div>
<div class="line"><span class="lineno">  186</span>    common.msg_role = ROLE_NODE;</div>
<div class="line"><span class="lineno">  187</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">if</span> (common.opcode != ESP_BLE_MESH_MODEL_OP_GEN_ONOFF_GET)</div>
<div class="line"><span class="lineno">  189</span>    {</div>
<div class="line"><span class="lineno">  190</span>        set.onoff_set.tid   = tid;</div>
<div class="line"><span class="lineno">  191</span>        set.onoff_set.onoff = state;</div>
<div class="line"><span class="lineno">  192</span>        set.onoff_set.op_en = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  193</span>        err = esp_ble_mesh_generic_client_set_state(&amp;common, &amp;set);</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">if</span> (err)</div>
<div class="line"><span class="lineno">  195</span>        {</div>
<div class="line"><span class="lineno">  196</span>            ESP_LOGE(TAG, <span class="stringliteral">&quot;Send Generic OnOff failed&quot;</span>);</div>
<div class="line"><span class="lineno">  197</span>            <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  198</span>        }</div>
<div class="line"><span class="lineno">  199</span>    }</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  201</span>        err = esp_ble_mesh_client_model_send_msg(common.model, &amp;common.ctx, common.opcode, 0, NULL, 0, <span class="keyword">true</span>, ROLE_NODE);</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">if</span> (err)</div>
<div class="line"><span class="lineno">  203</span>        {</div>
<div class="line"><span class="lineno">  204</span>            ESP_LOGE(TAG, <span class="stringliteral">&quot;Send Generic OnOff failed&quot;</span>);</div>
<div class="line"><span class="lineno">  205</span>            <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  206</span>        }</div>
<div class="line"><span class="lineno">  207</span>    }</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  209</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d3f328a8925dc2a3c8e621bbf1338bf" name="a6d3f328a8925dc2a3c8e621bbf1338bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d3f328a8925dc2a3c8e621bbf1338bf">&#9670;&#160;</a></span>meshx_onoff_reg_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t meshx_onoff_reg_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a664db840d8ac4280d88e7712cf277029">meshx_onoff_cli_cb</a></td>          <td class="paramname"><span class="paramname"><em>cb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>config_evt_bmap</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a callback function for On/Off client events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>Callback function to register. </td></tr>
    <tr><td class="paramname">config_evt_bmap</td><td>Bitmap of events to register the callback for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, or an error code on failure.</dd></dl>
<p>Register a callback function for On/Off client events.</p>
<p>This function allows users to register a callback for handling specific OnOff Client events based on a provided event bitmap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cb</td><td>Pointer to the callback function to register. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">config_evt_bmap</td><td>Bitmap of events to register for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, or an error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d9/d33/meshx__onoff__client_8c_source.html#l00096">96</a> of file <a class="el" href="../../d9/d33/meshx__onoff__client_8c_source.html">meshx_onoff_client.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span>{</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (cb == NULL || config_evt_bmap == 0)</div>
<div class="line"><span class="lineno">   99</span>    {</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">return</span> ESP_ERR_INVALID_ARG; <span class="comment">// Invalid arguments</span></div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_typedef" href="#a00f67e5ea8f4153315aa40a688c89767">meshx_onoff_cli_cb_reg_t</a> *new_entry = (<a class="code hl_typedef" href="#a00f67e5ea8f4153315aa40a688c89767">meshx_onoff_cli_cb_reg_t</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="#a00f67e5ea8f4153315aa40a688c89767">meshx_onoff_cli_cb_reg_t</a>));</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">if</span> (new_entry == NULL)</div>
<div class="line"><span class="lineno">  105</span>    {</div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">return</span> ESP_ERR_NO_MEM; <span class="comment">// Memory allocation failed</span></div>
<div class="line"><span class="lineno">  107</span>    }</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    new_entry-&gt;cb = cb;</div>
<div class="line"><span class="lineno">  110</span>    new_entry-&gt;evt_bmap = config_evt_bmap;</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">if</span> (xSemaphoreTake(meshx_onoff_cli_mutex, portMAX_DELAY) == pdTRUE)</div>
<div class="line"><span class="lineno">  113</span>    {</div>
<div class="line"><span class="lineno">  114</span>        SLIST_INSERT_HEAD(&amp;meshx_onoff_cli_cb_reg_table, new_entry, entries);</div>
<div class="line"><span class="lineno">  115</span>        xSemaphoreGive(meshx_onoff_cli_mutex);</div>
<div class="line"><span class="lineno">  116</span>    }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">return</span> ESP_OK;</div>
<div class="line"><span class="lineno">  119</span>}</div>
<div class="ttc" id="ameshx__onoff__client_8h_html_a00f67e5ea8f4153315aa40a688c89767"><div class="ttname"><a href="#a00f67e5ea8f4153315aa40a688c89767">meshx_onoff_cli_cb_reg_t</a></div><div class="ttdeci">struct meshx_onoff_cli_cb_reg meshx_onoff_cli_cb_reg_t</div><div class="ttdoc">Structure for On/Off client callback registration.</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_d422163b96683743ed3963d4aac17747.html">app</a></li><li class="navelem"><a class="el" href="../../dir_c65bd19e757d26cf4d732c1ae0727ae8.html">components</a></li><li class="navelem"><a class="el" href="../../dir_f203b345362cbfbb0face6aabfa16576.html">meshx</a></li><li class="navelem"><a class="el" href="../../dir_c2430d1846e6737dc28beab6505d1845.html">elements</a></li><li class="navelem"><a class="el" href="../../dir_c209dcfeb944a2f94c0266369fc78d3a.html">client</a></li><li class="navelem"><a class="el" href="../../dir_3264e684084f6e605556ee6b851a7e5b.html">models</a></li><li class="navelem"><a class="el" href="../../dir_4947b7f444668434bca4a6197e4825a0.html">gen_onoff_client</a></li><li class="navelem"><a class="el" href="../../d8/dd5/meshx__onoff__client_8h.html">meshx_onoff_client.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
